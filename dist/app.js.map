{"version":3,"sources":["../src/app.ts"],"sourcesContent":["import express from \"express\";\nimport cors from \"cors\";\nimport helmet from \"helmet\";\n// import { connect, set } from \"mongoose\";\nimport { NODE_ENV, PORT } from \"@config\";\n// import { dbConnection } from \"@databases\";\nimport swaggerJSDoc from \"swagger-jsdoc\";\nimport swaggerUi from \"swagger-ui-express\";\nimport { Routes } from \"@interfaces/routes.interface\";\nimport errorMiddleware from \"./middlewares/error.middleware\";\nimport * as pgk from \"../package.json\";\n\nclass App {\n  public app: express.Application;\n  public env: string;\n  public port: string | number;\n\n  constructor(routes: Routes[]) {\n    this.app = express();\n    this.env = NODE_ENV || \"development\";\n    this.port = PORT || 3000;\n\n    // this.connectToDatabase();\n    this.initializeSwagger();\n    this.initializeMiddlewares();\n    this.initializeRoutes(routes);\n  }\n\n  public listen() {\n    this.app.listen(this.port, () => {\n      console.info(`=================================`);\n      console.info(`======= ENV: ${this.env} =======`);\n      console.info(`App listening on http://localhost:${this.port}`);\n      console.info(`=================================`);\n    });\n  }\n\n  public getServer() {\n    return this.app;\n  }\n\n  // private connectToDatabase() {\n  //   if (this.env !== \"production\") {\n  //     set(\"debug\", true);\n  //   }\n\n  //   connect(dbConnection.url, dbConnection.options);\n  // }\n\n  private initializeSwagger() {\n    const options = {\n      swaggerDefinition: {\n        info: {\n          title: \"rq-api\",\n          version: pgk.version,\n          description: \"random quote api\",\n          contact: {\n            name: \"API Support\",\n            url: pgk.bugs.url,\n          },\n        },\n      },\n      apis: [\"swagger.yaml\"],\n    };\n\n    const specs = swaggerJSDoc(options);\n    this.app.use(\"/docs\", swaggerUi.serve, swaggerUi.setup(specs));\n  }\n\n  private initializeMiddlewares() {\n    this.app.use(cors({ origin: \"*\", credentials: false }));\n    this.app.use(\n      helmet({\n        crossOriginResourcePolicy: {\n          policy: \"cross-origin\",\n        },\n      })\n    );\n    this.app.use(errorMiddleware);\n    this.app.use(express.json());\n    this.app.use(express.urlencoded({ extended: true }));\n  }\n\n  private initializeRoutes(routes: Routes[]) {\n    routes.forEach((route) => {\n      this.app.use(\"/\", route.router);\n    });\n  }\n}\n\nexport default App;\n"],"names":["App","listen","app","port","console","info","env","getServer","initializeSwagger","options","swaggerDefinition","title","version","pgk","description","contact","name","url","bugs","apis","specs","swaggerJSDoc","use","swaggerUi","serve","setup","initializeMiddlewares","cors","origin","credentials","helmet","crossOriginResourcePolicy","policy","errorMiddleware","express","json","urlencoded","extended","initializeRoutes","routes","forEach","route","router","constructor","NODE_ENV","PORT"],"mappings":"AAAA;;;;+BA0FA,SAAmB;;aAAnB,QAAmB;;gDA1FC,SAAS;6CACZ,MAAM;+CACJ,QAAQ;wBAEI,UAAS;qDAEf,eAAe;yDAClB,oBAAoB;wDAEd,gCAAgC;qDACvC,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEtC,IAAA,AAAMA,GAAG,GAAT,MAAMA,GAAG;IAgBAC,MAAM,GAAG;QACd,IAAI,CAACC,GAAG,CAACD,MAAM,CAAC,IAAI,CAACE,IAAI,EAAE,IAAM;YAC/BC,OAAO,CAACC,IAAI,CAAC,CAAC,iCAAiC,CAAC,CAAC,CAAC;YAClDD,OAAO,CAACC,IAAI,CAAC,CAAC,aAAa,EAAE,IAAI,CAACC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;YACjDF,OAAO,CAACC,IAAI,CAAC,CAAC,kCAAkC,EAAE,IAAI,CAACF,IAAI,CAAC,CAAC,CAAC,CAAC;YAC/DC,OAAO,CAACC,IAAI,CAAC,CAAC,iCAAiC,CAAC,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;IACL;IAEOE,SAAS,GAAG;QACjB,OAAO,IAAI,CAACL,GAAG,CAAC;IAClB;IAUQM,iBAAiB,GAAG;QAC1B,MAAMC,OAAO,GAAG;YACdC,iBAAiB,EAAE;gBACjBL,IAAI,EAAE;oBACJM,KAAK,EAAE,QAAQ;oBACfC,OAAO,EAAEC,YAAG,CAACD,OAAO;oBACpBE,WAAW,EAAE,kBAAkB;oBAC/BC,OAAO,EAAE;wBACPC,IAAI,EAAE,aAAa;wBACnBC,GAAG,EAAEJ,YAAG,CAACK,IAAI,CAACD,GAAG;qBAClB;iBACF;aACF;YACDE,IAAI,EAAE;gBAAC,cAAc;aAAC;SACvB,AAAC;QAEF,MAAMC,KAAK,GAAGC,IAAAA,aAAY,QAAA,EAACZ,OAAO,CAAC,AAAC;QACpC,IAAI,CAACP,GAAG,CAACoB,GAAG,CAAC,OAAO,EAAEC,iBAAS,QAAA,CAACC,KAAK,EAAED,iBAAS,QAAA,CAACE,KAAK,CAACL,KAAK,CAAC,CAAC,CAAC;IACjE;IAEQM,qBAAqB,GAAG;QAC9B,IAAI,CAACxB,GAAG,CAACoB,GAAG,CAACK,IAAAA,KAAI,QAAA,EAAC;YAAEC,MAAM,EAAE,GAAG;YAAEC,WAAW,EAAE,KAAK;SAAE,CAAC,CAAC,CAAC;QACxD,IAAI,CAAC3B,GAAG,CAACoB,GAAG,CACVQ,IAAAA,OAAM,QAAA,EAAC;YACLC,yBAAyB,EAAE;gBACzBC,MAAM,EAAE,cAAc;aACvB;SACF,CAAC,CACH,CAAC;QACF,IAAI,CAAC9B,GAAG,CAACoB,GAAG,CAACW,gBAAe,QAAA,CAAC,CAAC;QAC9B,IAAI,CAAC/B,GAAG,CAACoB,GAAG,CAACY,QAAO,QAAA,CAACC,IAAI,EAAE,CAAC,CAAC;QAC7B,IAAI,CAACjC,GAAG,CAACoB,GAAG,CAACY,QAAO,QAAA,CAACE,UAAU,CAAC;YAAEC,QAAQ,EAAE,IAAI;SAAE,CAAC,CAAC,CAAC;IACvD;IAEQC,gBAAgB,CAACC,MAAgB,EAAE;QACzCA,MAAM,CAACC,OAAO,CAAC,CAACC,KAAK,GAAK;YACxB,IAAI,CAACvC,GAAG,CAACoB,GAAG,CAAC,GAAG,EAAEmB,KAAK,CAACC,MAAM,CAAC,CAAC;QAClC,CAAC,CAAC,CAAC;IACL;IAtEAC,YAAYJ,MAAgB,CAAE;QAC5B,IAAI,CAACrC,GAAG,GAAGgC,IAAAA,QAAO,QAAA,GAAE,CAAC;QACrB,IAAI,CAAC5B,GAAG,GAAGsC,OAAQ,SAAA,IAAI,aAAa,CAAC;QACrC,IAAI,CAACzC,IAAI,GAAG0C,OAAI,KAAA,IAAI,IAAI,CAAC;QAGzB,IAAI,CAACrC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAACkB,qBAAqB,EAAE,CAAC;QAC7B,IAAI,CAACY,gBAAgB,CAACC,MAAM,CAAC,CAAC;IAChC;CA8DD;MAED,QAAmB,GAAJvC,GAAG"}